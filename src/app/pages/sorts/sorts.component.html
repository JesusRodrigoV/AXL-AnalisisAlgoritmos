<div class="sorts-container">
  <mat-card class="controls-panel">
    <mat-card-content>
      <!-- Algoritmos -->
      <div class="algorithm-selector">
        <mat-button-toggle-group
          [(ngModel)]="selectedAlgorithm"
          aria-label="Sorting Algorithm"
        >
          <mat-button-toggle value="selection"
            >Selection Sort</mat-button-toggle
          >
          <mat-button-toggle value="insertion"
            >Insertion Sort</mat-button-toggle
          >
          <mat-button-toggle value="shell">Shell Sort</mat-button-toggle>
          <mat-button-toggle value="merge">Merge Sort</mat-button-toggle>
        </mat-button-toggle-group>
      </div>

      <!-- Controles -->
      <div class="input-controls">
        <!-- Selector de modo -->
        <mat-form-field appearance="outline">
          <mat-label>Modo de entrada</mat-label>
          <mat-select [(ngModel)]="arrayInputMode">
            <mat-option value="random">Aleatorio</mat-option>
            <mat-option value="manual">Manual</mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Controles para modo aleatorio -->
        <ng-container *ngIf="arrayInputMode === 'random'">
          <mat-form-field appearance="outline">
            <mat-label>Tamaño del array</mat-label>
            <input
              matInput
              type="number"
              [(ngModel)]="arraySize"
              min="10"
              max="200"
            />
            <mat-hint>Rango: 10-200 elementos</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Valor mínimo</mat-label>
            <input
              matInput
              type="number"
              [(ngModel)]="minValue"
              [max]="maxValue - 1"
            />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Valor máximo</mat-label>
            <input
              matInput
              type="number"
              [(ngModel)]="maxValue"
              [min]="minValue + 1"
            />
          </mat-form-field>
        </ng-container>

        <!-- Controles para modo manual -->
        <ng-container *ngIf="arrayInputMode === 'manual'">
          <mat-form-field appearance="outline" class="manual-input">
            <mat-label>Valores (separados por comas)</mat-label>
            <input
              matInput
              [(ngModel)]="manualArrayInput"
              placeholder="Ej: 5, 2, 8, 1, 9"
            />
            <mat-hint>Ingresa números separados por comas</mat-hint>
          </mat-form-field>
        </ng-container>

        <!-- Controles comunes -->
        <mat-form-field appearance="outline">
          <mat-label>Orden</mat-label>
          <mat-select [(ngModel)]="sortOrder">
            <mat-option value="asc">Ascendente</mat-option>
            <mat-option value="desc">Descendente</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field
          appearance="outline"
          *ngIf="selectedAlgorithm === 'shell'"
        >
          <mat-label>Valor inicial de h</mat-label>
          <input
            matInput
            type="number"
            [(ngModel)]="hValue"
            [min]="1"
            [max]="arraySize / 2"
          />
          <mat-hint
            >Valor recomendado: N/2 ({{
              arraySize / 2 | number: "1.0-0"
            }})</mat-hint
          >
        </mat-form-field>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Visualización -->
  <mat-card class="visualization-card">
    <mat-card-content>
      <div #chartContainer class="chart-container"></div>
    </mat-card-content>
  </mat-card>

  <!-- Timer y Botones -->
  <div class="bottom-controls">
    <div class="timer" *ngIf="executionTime > 0">
      <mat-card class="timer-card">
        <mat-card-content>
          <span class="timer-label">Tiempo de ejecución:</span>
          <span class="timer-value">{{ executionTime }}ms</span>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="action-buttons">
      <button
        mat-raised-button
        color="primary"
        (click)="generateNewArray()"
        [disabled]="sorting"
      >
        Generar Nuevo Array
      </button>

      <button
        mat-raised-button
        color="accent"
        (click)="startSort()"
        [disabled]="sorting"
      >
        Iniciar Ordenamiento
      </button>

      <button
        mat-raised-button
        color="primary"
        (click)="togglePause()"
        [disabled]="!sorting"
      >
        {{ isPaused ? "Reanudar" : "Pausar" }}
      </button>

      <button mat-raised-button color="warn" (click)="reset()">
        Limpiar Visualización
      </button>
    </div>
  </div>

  <app-help-button
    [helpContent]="helpContent"
    position="right"
  ></app-help-button>
</div>
